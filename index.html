<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#020202">
    <meta name="description" content="BACKSECRET Elite Command System">
    
    <title>BACKSECRET - Elite Authority</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Rajdhani:wght@500;600;700;800&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        royal: ['Cinzel', 'serif'],
                        tech: ['Rajdhani', 'sans-serif'],
                        mono: ['Share Tech Mono', 'monospace'],
                    },
                    colors: {
                        bgMain: '#020202',
                        bgCard: '#070707',
                        redMain: '#ff1111',
                        redDark: '#4a0000',
                    },
                    boxShadow: {
                        'red-glow': '0 0 20px rgba(255, 17, 17, 0.4)',
                    }
                }
            }
        }
    </script>
    <style>
        /* --- CORE SYSTEM --- */
        body {
            background-color: #020202;
            color: #cfcfcf;
            font-family: 'Rajdhani', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* Background Layers */
        body::before {
            content: ""; position: fixed; inset: 0;
            background: radial-gradient(circle at center, transparent 40%, rgba(0,0,0,0.6));
            pointer-events: none; z-index: 10;
        }
        body::after {
            content: ""; position: fixed; inset: 0;
            background: radial-gradient(circle at 50% 20%, rgba(255, 17, 17, 0.05), transparent 60%);
            pointer-events: none; z-index: 0;
        }
        
        .scanlines {
            position: fixed; inset: 0;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
            background-size: 100% 3px;
            pointer-events: none; z-index: 40; opacity: 0.12;
        }

        .logo-watermark {
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 80vw; max-width: 600px;
            opacity: 0.03; pointer-events: none; z-index: -1;
            filter: grayscale(100%) contrast(120%);
        }

        /* --- UI COMPONENTS --- */
        header { position: relative; box-shadow: inset 0 1px 0 rgba(255,255,255,0.06); }
        header img { filter: drop-shadow(0 0 8px rgba(255,255,255,0.1)); }
        
        .signal-dot {
            width: 6px; height: 6px; border-radius: 50%;
            background: #ff1111;
            box-shadow: 0 0 8px rgba(255,0,0,0.6);
            animation: signalBlink 3s infinite;
            margin-left: 8px;
        }
        @keyframes signalBlink { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }

        /* Card Design */
        .card-elite {
            background: linear-gradient(165deg, #090909 0%, #030303 100%);
            border: 1px solid #1a1a1a;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.08), 0 10px 30px rgba(0,0,0,0.9);
            position: relative; overflow: hidden;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            will-change: transform;
        }
        
        /* Glass Effect Support */
        @supports (backdrop-filter: blur(1px)) { .card-elite { backdrop-filter: blur(2px); } }

        /* Red Sweep Hover */
        .card-elite::after {
            content: ""; position: absolute; top: 0; left: -150%;
            width: 50%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 17, 17, 0.1), transparent);
            transform: skewX(-25deg); transition: left 0.6s ease; pointer-events: none;
        }
        .card-elite:hover::after { left: 200%; }

        /* Typography */
        .text-chrome {
            background: linear-gradient(to bottom, #ffffff 40%, #888 100%);
            -webkit-background-clip: text; background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.8));
        }
        
        .timer-display { transition: all 0.2s ease; will-change: transform; }
        .timer-display.standby { color: #555; text-shadow: none; animation: breathe 4s infinite; }
        @keyframes breathe { 0%, 100% { opacity: 0.8; } 50% { opacity: 1; } }

        /* States */
        .card-elite.active { animation: lockPulse 2s infinite; }
        .card-elite.active .timer-display { color: #ff1111; text-shadow: 0 0 15px rgba(255, 17, 17, 0.6); font-weight: 800; letter-spacing: -1px; }
        
        /* Localized Critical Shake */
        .card-elite.critical { border-color: #4a0000; animation: lockPulse 2s infinite, shake 0.4s infinite; }
        @keyframes shake { 0%,100% { transform: translateX(0); } 25% { transform: translateX(1px); } 75% { transform: translateX(-1px); } }
        @keyframes lockPulse { 0%, 100% { border-color: #4a0000; } 50% { border-color: #8a0000; } }

        /* Buttons */
        .btn-execute {
            background: linear-gradient(180deg, #1a0000 0%, #050000 100%);
            border: 1px solid #330000; color: #cc0000;
            font-family: 'Rajdhani', sans-serif; font-weight: 700; letter-spacing: 2px;
            transition: all 0.2s; position: relative; overflow: hidden;
        }
        .btn-execute:hover:not(:disabled) { color: #ff1111; border-color: #660000; text-shadow: 0 0 8px #ff1111; box-shadow: 0 0 20px rgba(255, 17, 17, 0.2); }
        .btn-execute:disabled { background: #050505; border-color: #1a1a1a; color: #333; cursor: not-allowed; }

        /* Boot Overlay */
        #boot-overlay { position: fixed; inset: 0; background: #000; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s ease-out; }
        .boot-btn { border: 1px solid #333; padding: 1rem 3rem; color: #666; font-family: 'Cinzel', serif; font-weight: 700; letter-spacing: 2px; background: rgba(10,10,10,0.8); cursor: pointer; transition: 0.3s; }
        .boot-btn:hover { border-color: #ff1111; color: #ff1111; box-shadow: 0 0 30px rgba(255, 17, 17, 0.2); }
        .hidden { opacity: 0; pointer-events: none; }

        .input-elite { background: transparent; border: none; border-bottom: 1px solid #222; color: #aaa; font-family: 'Rajdhani', sans-serif; font-weight: 600; text-transform: uppercase; transition: 0.3s; width: 100%; }
        .input-elite:focus { outline: none; border-bottom-color: #ff1111; color: #fff; }
        
        /* Activity Button Style */
        .btn-activity {
            color: #ff1111; border-bottom: 1px solid transparent; transition: all 0.3s;
        }
        .btn-activity:hover { border-color: #ff1111; text-shadow: 0 0 10px rgba(255, 17, 17, 0.5); }
    </style>
</head>
<body class="p-4 md:p-8 flex flex-col items-center min-h-screen relative">

    <div class="scanlines"></div>
    <img src="https://img5.pic.in.th/file/secure-sv1/Logo9c1f24a21fb14b54.png" alt="BackSecret Logo" class="logo-watermark">

    <!-- Boot Overlay -->
    <div id="boot-overlay">
        <div class="mb-8 opacity-60">
            <img src="https://img5.pic.in.th/file/secure-sv1/Logo9c1f24a21fb14b54.png" width="90" class="grayscale contrast-125">
        </div>
        <button onclick="bootSystem()" class="boot-btn" id="boot-btn">INITIALIZE SYSTEM</button>
        <div class="mt-4 text-xs font-mono text-gray-600 tracking-widest">SECURE CONNECTION REQUIRED</div>
    </div>

    <!-- Header -->
    <header class="w-full max-w-[1500px] flex flex-col md:flex-row justify-between items-center mb-8 z-20 border-b border-white/5 pb-6 transition-opacity duration-1000 opacity-0" id="main-header">
        <div class="flex items-center gap-6 mb-4 md:mb-0 pl-2">
            <img src="https://img5.pic.in.th/file/secure-sv1/Logo9c1f24a21fb14b54.png" alt="Logo" class="w-14 h-14 object-contain">
            <div class="flex flex-col">
                <h1 class="text-4xl md:text-5xl font-royal font-bold text-chrome tracking-widest leading-none">BACKSECRET</h1>
                <div class="flex items-center gap-3 mt-2">
                    <span class="h-[1px] w-6 bg-red-800"></span>
                    <p class="text-[10px] font-mono tracking-[0.4em] text-red-700 uppercase">ELITE AUTHORITY</p>
                    <div class="signal-dot"></div>
                </div>
            </div>
        </div>
        <div class="flex gap-8 font-mono text-sm pr-4">
            <div class="flex flex-col items-end">
                <span class="text-[9px] text-gray-600 uppercase tracking-widest">Active Locks</span>
                <span class="text-xl font-bold text-red-600 drop-shadow-[0_0_5px_rgba(255,0,0,0.5)]" id="active-locks-text">0</span>
            </div>
            <div class="w-px bg-white/5 h-8 my-auto"></div>
            <div class="flex flex-col items-end">
                <span class="text-[9px] text-gray-600 uppercase tracking-widest">Next Cycle</span>
                <span class="text-xl font-bold text-gray-400" id="next-ready-display">--:--</span>
            </div>
        </div>
    </header>

    <!-- Controls -->
    <div class="w-full max-w-[1500px] flex justify-between items-end gap-3 mb-6 z-20 transition-opacity duration-1000 opacity-0" id="controls-bar">
        <div class="flex items-center gap-6">
            <!-- LINK TO ACTIVITY -->
            <a href="activity.html" class="text-[10px] font-mono tracking-widest flex items-center gap-2 btn-activity group">
                <i class="fa-solid fa-satellite-dish group-hover:animate-pulse"></i> ACTIVITY MONITOR
            </a>
            <button onclick="toggleCompactMode()" class="text-[10px] font-mono text-gray-600 hover:text-white transition-colors flex items-center gap-2 tracking-widest">
                <i class="fa-solid fa-layer-group"></i> <span id="view-text">GRID VIEW</span>
            </button>
        </div>
        <div class="flex gap-2">
            <button onclick="toggleSound()" id="soundBtn" class="w-8 h-8 border border-white/10 flex items-center justify-center text-gray-600 hover:text-red-500 hover:border-red-900 transition bg-black/50 text-xs">
                <i class="fa-solid fa-volume-high"></i>
            </button>
            <button onclick="requestNotificationPermission()" class="h-8 px-3 border border-white/10 flex items-center justify-center text-[10px] text-gray-600 hover:text-white hover:border-gray-500 transition bg-black/50 font-mono tracking-wider">
                NOTIFY
            </button>
        </div>
    </div>

    <!-- Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-5 w-full max-w-[1500px] z-20 pb-20 transition-opacity duration-1000 opacity-0" id="timerContainer"></div>

    <!-- Footer -->
    <footer class="fixed bottom-0 w-full bg-black/90 border-t border-white/5 py-2 z-50 backdrop-blur-sm flex justify-center">
         <button onclick="resetAllData()" class="text-[9px] font-mono text-red-900/60 hover:text-red-600 transition-colors uppercase tracking-[0.2em]">
            <i class="fa-solid fa-triangle-exclamation mr-1"></i> System Reset
        </button>
    </footer>

    <!-- Audio (Using CDN for reliability in Main Timer) -->
    <audio id="clickSound" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.m4a"></audio>
    <audio id="warnSound" src="https://assets.mixkit.co/active_storage/sfx/2572/2572-preview.m4a"></audio>
    <audio id="alarmSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.m4a"></audio>
    <audio id="ambientHum" loop src="https://assets.mixkit.co/active_storage/sfx/2515/2515-preview.m4a"></audio>

    <script>
        // CONFIG
        const TOTAL_STORES = 5;
        const DEFAULT_COOLDOWN_MINUTES = 20;
        const STORE_KEY_PREFIX = 'backsecret_authority_';
        
        let stores = [];
        let soundEnabled = true;
        let isCompact = false;
        let lastSecondTick = -1;

        // --- SYSTEM CORE ---
        function bootSystem() {
            // Unlock Audio Context
            if(soundEnabled) {
                const hum = document.getElementById('ambientHum');
                hum.volume = 0.05;
                hum.play().catch(()=>{});
            }
            
            // Animation
            const overlay = document.getElementById('boot-overlay');
            overlay.classList.add('hidden');
            document.body.style.filter = "brightness(1.3)";
            setTimeout(() => { document.body.style.filter = "none"; }, 150);

            setTimeout(() => {
                overlay.style.display = 'none';
                revealInterface();
            }, 600);
        }

        function revealInterface() {
            document.getElementById('main-header').style.opacity = '1';
            document.getElementById('controls-bar').style.opacity = '1';
            document.getElementById('timerContainer').style.opacity = '1';
            
            loadStoreData();
            if(localStorage.getItem('backsecret_compact') === 'true') {
                isCompact = true;
                updateViewBtn();
            }
            renderTimers();
            requestAnimationFrame(loop);
            updateSoundIcon();
        }

        function loadStoreData() {
            stores = [];
            for (let i = 0; i < TOTAL_STORES; i++) {
                const saved = localStorage.getItem(STORE_KEY_PREFIX + i);
                if (saved) {
                    const parsed = JSON.parse(saved);
                    if(parsed.warned === undefined) parsed.warned = false;
                    if(parsed.cooldown === undefined) parsed.cooldown = DEFAULT_COOLDOWN_MINUTES;
                    stores.push(parsed);
                } else {
                    stores.push({ id: i, name: `TARGET 0${i + 1}`, cooldown: DEFAULT_COOLDOWN_MINUTES, endTime: null, status: 'ready', warned: false });
                }
            }
        }

        function saveStoreData(index) {
            localStorage.setItem(STORE_KEY_PREFIX + index, JSON.stringify(stores[index]));
        }

        function renderTimers() {
            const container = document.getElementById('timerContainer');
            let htmlBuffer = '';
            
            container.className = isCompact 
                ? 'grid grid-cols-2 md:grid-cols-4 xl:grid-cols-6 gap-3 w-full max-w-[1500px] z-20 pb-20 transition-opacity duration-1000 opacity-1'
                : 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-5 w-full max-w-[1500px] z-20 pb-20 transition-opacity duration-1000 opacity-1';

            stores.forEach((store, index) => {
                htmlBuffer += `
                    <div class="card-elite rounded p-5 flex flex-col group h-full justify-between relative" id="card-${index}">
                        <div class="absolute top-3 right-3 opacity-20"><img src="https://img5.pic.in.th/file/secure-sv1/Logo9c1f24a21fb14b54.png" class="logo-badge w-6 h-6"></div>
                        <div class="flex justify-between items-start mb-2 opacity-60 group-hover:opacity-100 transition-opacity">
                            <div class="w-full mr-6">
                                <label class="text-[8px] text-gray-500 font-mono tracking-widest uppercase block mb-1">UNIT_ID_0${index+1}</label>
                                <input type="text" value="${store.name}" onchange="updateName(${index}, this.value)" class="input-elite w-full text-sm" placeholder="SET NAME">
                            </div>
                            <button onclick="setCustomTime(${index})" class="text-gray-700 hover:text-white transition-colors text-[10px] pt-3"><i class="fa-solid fa-gear"></i></button>
                        </div>
                        <div class="flex flex-col items-center justify-center py-4 my-2 relative">
                            <div class="font-tech text-5xl font-bold tracking-tighter text-chrome timer-display transition-colors" id="timer-display-${index}">00:00</div>
                            <div class="mt-2" id="status-container-${index}"><span class="text-[9px] font-mono tracking-[0.3em] text-gray-500 uppercase">STANDBY</span></div>
                        </div>
                        <div class="w-full h-1 bg-[#1a1a1a] rounded-full mt-2 overflow-hidden"><div id="progress-${index}" class="h-full bg-red-600 w-0 transition-all duration-1000"></div></div>
                        <div class="grid grid-cols-4 gap-1 mt-auto pt-4">
                            <button onclick="startTimer(${index})" id="btn-start-${index}" class="col-span-4 btn-execute py-3 text-sm flex items-center justify-center gap-2 group-hover:tracking-widest transition-all">EXECUTE</button>
                            <button onclick="adjustTime(${index}, -1)" class="col-span-1 bg-[#0a0a0a] border border-[#1a1a1a] text-gray-600 hover:text-white hover:border-gray-600 text-[9px] py-1 font-mono transition-colors">-1M</button>
                            <button onclick="resetTimer(${index})" class="col-span-3 bg-[#0a0a0a] border border-[#1a1a1a] text-gray-500 hover:text-red-500 hover:border-red-900 text-[9px] py-1 font-mono uppercase tracking-wider transition-colors"><i class="fa-solid fa-rotate-left mr-1"></i> RESET</button>
                        </div>
                    </div>`;
            });
            container.innerHTML = htmlBuffer;
            updateTimers(true); 
        }

        function loop() { updateTimers(false); requestAnimationFrame(loop); }

        function updateTimers(forceUpdate = false) {
            const now = Date.now();
            const currentSecond = Math.floor(now / 1000);
            const isNewSecond = (currentSecond !== lastSecondTick) || forceUpdate;
            if(isNewSecond) lastSecondTick = currentSecond;

            let activeLocksCount = 0;
            let nearestTime = Infinity;

            stores.forEach((store, index) => {
                const card = document.getElementById(`card-${index}`);
                const display = document.getElementById(`timer-display-${index}`);
                const statusContainer = document.getElementById(`status-container-${index}`);
                const progress = document.getElementById(`progress-${index}`);
                const btnStart = document.getElementById(`btn-start-${index}`);
                if (!card) return;

                if (store.status === 'cooldown' && store.endTime) {
                    const distance = store.endTime - now;
                    activeLocksCount++;
                    if (distance > 0 && store.endTime < nearestTime) nearestTime = store.endTime;

                    if (distance < 0) {
                        finishCooldown(index);
                    } else {
                        if (isNewSecond) {
                            const m = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                            const s = Math.floor((distance % (1000 * 60)) / 1000);
                            display.innerText = `${pad(m)}:${pad(s)}`;
                            display.classList.remove('tick'); void display.offsetWidth; display.classList.add('tick');

                            if (!card.classList.contains('active')) {
                                display.classList.remove('standby');
                                statusContainer.innerHTML = `<span class="text-[10px] font-mono tracking-[0.25em] text-red-600 uppercase text-shadow-glow animate-pulse">LOCKED</span>`;
                                card.classList.add('active');
                                btnStart.disabled = true;
                                btnStart.innerHTML = `SYSTEM LOCKED`;
                            }
                        }

                        if (distance < 10000) card.classList.add('critical');
                        else card.classList.remove('critical');

                        const total = store.cooldown * 60 * 1000;
                        const pct = Math.max(0, Math.min(100, (distance / total) * 100));
                        progress.style.width = `${pct}%`;

                        if (distance < 60000 && !store.warned) {
                            playWarn();
                            store.warned = true;
                            // Localized Shake
                            card.classList.add('card-hit'); setTimeout(() => card.classList.remove('card-hit'), 200);
                            saveStoreData(index);
                        }
                    }
                } else {
                    if(isNewSecond) {
                        if (display.innerText !== "STANDBY") {
                            display.innerText = "STANDBY"; display.classList.add('standby');
                            statusContainer.innerHTML = `<span class="text-[9px] font-mono tracking-[0.3em] text-gray-500 uppercase">AWAITING INPUT</span>`;
                            card.classList.remove('active'); card.classList.remove('critical');
                            btnStart.disabled = false; btnStart.innerHTML = `EXECUTE (${store.cooldown}M)`;
                            progress.style.width = '0%'; 
                        }
                    }
                }
            });

            if(isNewSecond) {
                document.getElementById('active-locks-text').innerText = `${activeLocksCount}`;
                document.getElementById('next-ready-display').innerText = nearestTime !== Infinity ? getTimeStr(nearestTime) : "--:--";
                const soundBtn = document.getElementById('soundBtn');
                if(activeLocksCount > 0 && soundEnabled) soundBtn.classList.add("animate-pulse"); else soundBtn.classList.remove("animate-pulse");
                if(activeLocksCount > 0 && soundEnabled) {
                    const click = document.getElementById('clickSound');
                    click.volume = 0.03; click.currentTime = 0; click.play().catch(()=>{});
                }
            }
        }

        function startTimer(index) { playClick(0.3); const now = Date.now(); stores[index].status = 'cooldown'; stores[index].endTime = now + (stores[index].cooldown * 60 * 1000); stores[index].warned = false; saveStoreData(index); updateTimers(true); }
        function resetTimer(index) { playClick(0.3); stores[index].status = 'ready'; stores[index].endTime = null; saveStoreData(index); updateTimers(true); }
        function adjustTime(index, min) { if(stores[index].status !== 'cooldown') return; playClick(0.2); stores[index].endTime += (min * 60 * 1000); saveStoreData(index); updateTimers(true); }
        function setCustomTime(index) { const m = prompt(`Set Cooldown (Minutes):`, stores[index].cooldown || DEFAULT_COOLDOWN_MINUTES); if(m && !isNaN(m)) { playClick(0.2); stores[index].cooldown = parseFloat(m); saveStoreData(index); renderTimers(); } }
        function toggleCompactMode() { isCompact = !isCompact; updateViewBtn(); localStorage.setItem('backsecret_compact', isCompact); renderTimers(); playClick(0.2); }
        function updateViewBtn() { document.getElementById('view-text').innerText = isCompact ? "NORMAL VIEW" : "GRID VIEW"; }
        function updateName(index, val) { stores[index].name = val; saveStoreData(index); }
        function finishCooldown(index) { stores[index].status = 'ready'; stores[index].endTime = null; saveStoreData(index); if(soundEnabled) document.getElementById('alarmSound').play().catch(()=>{}); if(Notification.permission === "granted") new Notification("TARGET UNLOCKED", { body: `${stores[index].name} is Primed.` }); updateTimers(true); }
        function resetAllData() { if(confirm("CONFIRM: WIPE SYSTEM DATA?")) { playWarn(); localStorage.clear(); location.reload(); } }
        function pad(n) { return n < 10 ? '0' + n : n; }
        function getTimeStr(timestamp) { const d = new Date(timestamp); return `${pad(d.getHours())}:${pad(d.getMinutes())}`; }
        function playClick(vol = 0.2) { if(soundEnabled) { const s = document.getElementById('clickSound'); s.volume = vol; s.currentTime = 0; s.play().catch(()=>{}); } }
        function playWarn() { if(soundEnabled) { const s = document.getElementById('warnSound'); s.volume = 0.4; s.currentTime=0; s.play().catch(()=>{}); } }
        function toggleSound() { soundEnabled = !soundEnabled; updateSoundIcon(); const hum = document.getElementById('ambientHum'); if(soundEnabled) { playClick(0.2); if(document.getElementById('boot-overlay').style.display === 'none') { hum.volume = 0.08; hum.play().catch(()=>{}); } } else { hum.pause(); } }
        function updateSoundIcon() { const btn = document.getElementById('soundBtn'); btn.innerHTML = soundEnabled ? '<i class="fa-solid fa-volume-high text-red-500"></i>' : '<i class="fa-solid fa-volume-xmark text-gray-600"></i>'; btn.style.borderColor = soundEnabled ? '#4a0000' : 'rgba(255,255,255,0.1)'; }
        function requestNotificationPermission() { if(!("Notification" in window)) return; Notification.requestPermission().then(p => { if(p === "granted") { new Notification("SYSTEM LINKED"); playClick(0.2); } }); }
    </script>
</body>
</html>